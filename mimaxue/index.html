<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="密码学基础, Hexo">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>密码学基础 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/riyu">
          
          <span>日语</span>
        </a>
      </li>
      
      <li>
        <a href="/huibian">
          
          <span>汇编语言</span>
        </a>
      </li>
      
      <li>
        <a href="/computer">
          
          <span>计算机网络</span>
        </a>
      </li>
      
      <li>
        <a href="/mimaxue">
          
          <span>密码学基础</span>
        </a>
      </li>
      
      <li>
        <a href="/jisuanjiyuanli">
          
          <span>计算机组成原理</span>
        </a>
      </li>
      
      <li>
        <a href="/shudian">
          
          <span>数字电子技术基础</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/riyu " style="margin-left:75px">
				  
		          <span>日语</span>
                  </a>
                </li>
              
                <li>

                  <a href="/huibian " style="margin-left:75px">
				  
		          <span>汇编语言</span>
                  </a>
                </li>
              
                <li>

                  <a href="/computer " style="margin-left:75px">
				  
		          <span>计算机网络</span>
                  </a>
                </li>
              
                <li>

                  <a href="/mimaxue " style="margin-left:75px">
				  
		          <span>密码学基础</span>
                  </a>
                </li>
              
                <li>

                  <a href="/jisuanjiyuanli " style="margin-left:75px">
				  
		          <span>计算机组成原理</span>
                  </a>
                </li>
              
                <li>

                  <a href="/shudian " style="margin-left:75px">
				  
		          <span>数字电子技术基础</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">密码学基础</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-03-11
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.1k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="密码学基础"><a href="#密码学基础" class="headerlink" title="密码学基础"></a>密码学基础</h2><p>1.唯密文攻击：密码分析者仅知道一些密文。</p>
<p>2.已知明文攻击：密码分析者知道一些明文和相应的密文。</p>
<p>3.选择明文攻击：密码分析者可以选择一些明文，并得到相应的密文。</p>
<p>4.选择密文攻击：密码分析者可以选择一些密文，并得到相应的明文。</p>
<p>加密 EK（M）=C</p>
<p>解密 DK（C）=M</p>
<p>对密文解密记为 DK（EK（M））=M</p>
<p><img src="./index/107.png"></p>
<p>无条件安全的(不可破译的)：一次一密方案(一次一密乱码本)</p>
<p>密码算法只要满足以下两条准则之一就行：</p>
<p>1.破译密文的代价超过被加密信息的价值。</p>
<p>2.破译密文所花的时间超过信息的有用期。</p>
<p>置换密码:</p>
<p>文中的字或字母被重新排列，字或字母本身不变，但位置发生了改变，形成密文</p>
<h3 id="单表代替密码"><a href="#单表代替密码" class="headerlink" title="单表代替密码"></a>单表代替密码</h3><p>单表代替密码:</p>
<p>把明文中的每一个字符替换成密文字母表中的另一个字符，并使用密钥K与之进行运算，得到密文；接收者对密文进行逆运算就可以恢复出明文</p>
<p>在单表代替密码中，只使用一个密文字母表，并且用密文字母表中的一个字母来代替一个明文字母表中的一个字母。</p>
<p>1、加法密码</p>
<p>f (ai) = bi = aj</p>
<p>j = i+k(mod n) , (ai∈A ,0&lt;k&lt;n)</p>
<p>凯撒密码就是著名的加法密码</p>
<p>2.乘法密码</p>
<p>f (ai) = bi = aj</p>
<p>j = i*k(mod n) , (ai∈A ,0&lt;k&lt;n，(k,n)=1)</p>
<p>3.仿射密码(乘法密码和加法密码的结合)</p>
<p>f (ai) = bi = aj</p>
<p>j = k0 +i*k1 (mod n) , (ai∈A ,0&lt;k0&lt;n，(k1 ,n)=1)</p>
<p>4.密钥短语代替密码</p>
<p>这种密码选用一个英文短语或者单词串作为密钥，称为密钥字或密钥短语，</p>
<p>如密钥短语密码为: hello -&gt; helo</p>
<p>明文: abcdefghijklmnopqrstuvwxyz</p>
<p>密文: heloabcdfgijkmnpqrstuvwxyz</p>
<h3 id="多表代换密码"><a href="#多表代换密码" class="headerlink" title="多表代换密码"></a>多表代换密码</h3><p>多表代换密码首先将明文M分为由n个字母构成的分组M1,M2,M3···Mj,对每个分组Mi的加密为：</p>
<p>Ci=A*Mi+B(mod N),i=1,2,···,j</p>
<p>其中(A,B)是密钥，A是n*n的可逆矩阵，满足gcd(|A|,N)=1(|A|是行列式)。B=(B1,B2,···,Bn)^T,C=(C1,C2,···,Cn)^T,M=(m1,m2,···,mn)^T。对密文分组Ci的揭秘为：</p>
<p>Mi=A^-1(Ci-B)(mod N),i=1,2,···,j</p>
<p><img src="./index/cy1.png"></p>
<p><img src="./index/cy2.png"></p>
<p><img src="./index/cy3.png"></p>
<p><img src="./index/cy4.png"></p>
<h1 id="分组密码"><a href="#分组密码" class="headerlink" title="分组密码"></a>分组密码</h1><p>定义：若明文流被分割为等长串，各串用相同的加密算法和相同的密钥进行加密，就是分组密码</p>
<p>1.明文和密文是固定长度为n的比特串m=m1m2m3···mn,c=c1c2c3···cn</p>
<p>2.加密密钥和解密密钥相等，是固定长度为r的比特串k=k1k2k3···kr</p>
<p>3.加密算法为c=Enck(m)</p>
<p>4.解密算法为m=Deck(c)=Deck(Enck(m))</p>
<h3 id="分组密码的构造原则"><a href="#分组密码的构造原则" class="headerlink" title="分组密码的构造原则"></a>分组密码的构造原则</h3><p>1.要有足够大的分组长度（保证足够大的明文空间，避免给攻击者提供太多的明文统计特征信息）</p>
<p>2.密钥空间要尽可能大（防止穷举密钥）</p>
<p>3.保证足够强的密码算法复杂度以加强分组密码算法自身的安全性：</p>
<p>方法：</p>
<p>-先将一个明文分组划分为若干子组分别进行处理，然后合并起来再做一些适当的变换，以增大密码算法强度，采用这样的措施也便于密码算法的实际分析和评测</p>
<p>-采用乘积密码的思想，通过两种或两种以上简单密码的逐次应用，构成强度比其中任何一个更强的加密结果，有效客服单一密码变换的弱点</p>
<p>4.软件实现尽量采用子块和简单运算，采用加法，乘法，异或和移位等指令，易于标准处理器完成运算</p>
<p>5.加解密硬件结构最好一致这样便于应用超大规模集成芯片实现，以简化系统整体结构的复杂度</p>
<h3 id="增加密码算法复杂度的方法"><a href="#增加密码算法复杂度的方法" class="headerlink" title="增加密码算法复杂度的方法"></a>增加密码算法复杂度的方法</h3><p>在分组密码算法的安全策略中，用的最多的就是采用代换-置换网络，简称为SP网络</p>
<p>S变换：把输入的一个n长的比特串转化为另一个m长的比特串输出（起到混淆的效果）</p>
<p>P盒变换：通过把一个比特串中各比特的位置次序重新排序而得到新的比特串的变换（起到扩散效果）</p>
<p>这种结构的一个典型代表是Feistel密码结构</p>
<p>基本思路是采用“扩散与混乱”两个主要思想：</p>
<p>混乱：明文与密钥，以及密文之间的统计关系尽可能复杂化，使破译者无法获得出相互间的依赖关系</p>
<p>扩散：是指明文中的每一位（包括密钥的每一位）直接或间接影响输出密文中的许多位，以隐蔽明文的统计信息</p>
<p>典型代表为LUCIFFER分组密码算法（DES前期模型）</p>
<p>特点：通过替代和置换（S-P网络）交替的方式来构造分组密码，其实就是基于混乱和扩散原理实现加解密运算</p>
<p>需要重点考虑：</p>
<p>S盒的设计</p>
<p>P盒的设计</p>
<p>轮函数F的设计</p>
<p>迭代轮数</p>
<p>密钥扩展算法</p>
<p>?&gt;S盒和P盒的设计准则：</p>
<p>分组网络中的S-P网络目的就是实现高度的非线性化和良好的雪崩效应</p>
<p>S盒：分组密码的非线性部分的核心，有加密算法混淆作用，直接影响整个分组密码算法的安全强度</p>
<p>-非线性度：有：群加密运算乘法 mod<br>^n+1(如IDEA)或利用非素数域GF(2^n)上的幂函数(如AES)来构造S盒，以增强高度非线性变换</p>
<p>-分均匀性：抵抗差分密码分析的能力要强</p>
<p>差分分析是一种选择明文攻击，其基本思想是：通过分析特定明文差分对相对应密文差分影响来获得尽可能大的密钥。</p>
<p>-雪崩效应：是混淆-扩散特性的进一步反映。即要求输入有一比特发生变化时，将导致输出有一半的比特位发生变化(与P盒功能有关)</p>
<p>-可逆性完整，没有“陷门”</p>
<p>P盒：实现良好的雪崩效应</p>
<p>?&gt;轮函数F指迭代分组密码中单轮加密算法的非线性函数，其设计准则就是保证非线性度要强，具体通过位独立和雪崩效应来实现</p>
<p>一般而言：分组密码迭代轮数越多，密码分析越困难;一般采用r=8，10，12，16，20;迭代轮数的设计准则是：使密码分析的难度大于简单的穷举攻击的难度</p>
<p>指标：</p>
<p>1.安全性：轮函数F必须能抵抗所有已知的密码攻击方法，尤其是抵抗差分密码分析和线性密码分析</p>
<p>2.速度</p>
<p>3.灵活性：支持密码算法在多平台和多处理器上实现</p>
<p><img src="./index/cy5.png"></p>
<h3 id="DES密码"><a href="#DES密码" class="headerlink" title="DES密码"></a>DES密码</h3><p>DES密码算法采用了Feistel密码的S-P结构，其特点是：加密和解密使用同一算法，同一密钥，同一结构。区别是16轮加密子密钥顺序为K1,K2,···，K16,解密子密钥顺序为K16,K15,···K1</p>
<p>共有三个变换阶段：</p>
<p>?&gt;初始置换，乘积置换和逆初始置换</p>
<p><img src="./index/cy6.png"></p>
<p>第一步，初始置换IP：</p>
<p>主要用于对明文m中的各位进行换位，目的在于打乱明文m中各位的排序次序</p>
<p><img src="./index/cy7.png"></p>
<p>第二步，16轮迭代（乘积变换）：</p>
<p>将第一步换位得到的64位结果，分为两半，L0=m’1m’2···m’32,R0=m’33m’34···m’64,16轮迭代可以表示为：</p>
<p><img src="./index/cy8.png"></p>
<p>第三步，逆初始置换IP^-1:</p>
<p><img src="./index/cy9.png"></p>
<p>轮换的核心是f函数，他是非线性的，轮函数F由3个部分组成：扩展置换（E盒），非线性代换（S盒）和线性置换（P盒）。</p>
<p><img src="./index/cy10.png"></p>
<p>E盒的作用是将32为扩展为48位，其扩展规则按下表进行。该表大小为6*8，去掉最左和最右两行，中间的四列包含了1-32的顺序。第1列和第6列分别是对第4和第1列的扩展。经过扩展置换，32位的输入得到了48位的输出。</p>
<p><img src="./index/cy11.png"></p>
<p>?&gt;S盒的作用是进行非线性代换。S盒是DES中唯一的非线性部分，DES的安全强度主要取决于S盒的安全程度。S盒运算其实是一个查表运算。在E盒的扩展之后得到了48位的数据，将其和48位的子密钥进行异或运算，这是密钥参与运算的步骤。将其分成8个组，每组6个，送到8个S盒中去。每一个S盒都是一个6位输入4位输出的结构，也就是说，48位输入到8个S盒会得到4*8=32位的输出。6位输入到8位输出的映射关系如下表所示，其中，第一位和最后一位作为行号，第二位到第五位最为列号。例如，101100，则行号为10=2，列号为0110=6。查得（2,6）=2，化成二进制位0010。注意，8个S盒的映射关系各不相同。</p>
<p><img src="./index/cy12.png"></p>
<p><img src="./index/cy13.png"></p>
<p>P盒的作用只是进行简单的位置置换，只是简单地把一位换成另一位，不进行扩展和压缩。经过P盒操作，32位的输入得到32位的输出。</p>
<p><img src="./index/cy14.png"></p>
<p>?&gt;DES子密钥生成方法</p>
<p>DES的初始64位密钥通过置换选择PC-1得到有效的56位密钥。这56位分为2个28位数据C0和D0。每轮迭代中Ci-1和Di-1分别循环左移1位或2位，移位后的值作为下一轮的输入，同时也作为置换选择PC-2的输入，通过置换选择PC-2产生一个48位的输出，即为一个子密钥。64位密钥生成了16个48位的子密钥。</p>
<p><img src="./index/cy15.png"></p>
<p>PC-1用于置换选择1</p>
<p><img src="./index/cy16.png"></p>
<p>PC-2用于置换选择2</p>
<p><img src="./index/cy17.png"></p>
<p>DES的解密与加密类似，可共用一个算法，不同的是子密钥顺序使用相反，依次为k16,k15,···,k1</p>
<p>DES的安全性：</p>
<p>DES算法的密钥扩展算法有缺陷：存在弱密钥和半弱密钥</p>
<p>弱密钥：指当k1=k2=···=k16时，满足DESk(m)=DESk^-1(m)或DESk(DESk(m))=m。当C0,D0的位模式为全0或全1时存在四种弱密钥</p>
<p>半弱密钥：是指若存在k和k’，使得DESk(m)=DESk^-1(m)或DESk(DESk’(m))=m,则k和k’构成半弱密钥，DES至少有12个半弱密钥存在，半弱密钥将导致明文加密成相同的密文，通过密钥k’能够破解由密钥k加密的信息</p>
<p>DES迭代次数16轮偏少</p>
<p>DES有效密钥位数偏短</p>
<p>软件实现太慢</p>
<p>?&gt;针对DES密钥位数和迭代次数偏少等问题，推出了新的DES方案：</p>
<p>DES-EEE3模式：使用三个不同的密钥(K1,K2,K3)采用三次加密算法</p>
<p>DES-EDE3模式：使用三个不同的密钥(K1,K2,K3)采用加密-解密-加密算法</p>
<p>DES-EEE2模式：使用两个不同密钥(K1=K3,K2)采用三次加密算法</p>
<p>DES-EDE2模式：使用两个不同密钥(K1=K3,K2)采用加密-解密-加密算法</p>
<h3 id="IDEA密码算法"><a href="#IDEA密码算法" class="headerlink" title="IDEA密码算法"></a>IDEA密码算法</h3><p>IDEA没有采用直观的S-P网络结构，而是采用混合的乘加网路结构来实现混淆和扩散功能</p>
<p><img src="./index/cy18.png"></p>
<p>将64比特的数据块分成4个子块，并定义4个子块为X1,X2,X3,X4,每个子块16比特，作为第一轮迭代的输入，整个过程需要八轮迭代来完成。算法的每轮迭代都是在4个子块之间进行，主要执行与16比特的子密钥异或操作，mod2^16加法运算和mod(2^16+1)乘法运算</p>
<p><img src="./index/cy19.png"></p>
<p>解密过程基本上一样，只是子密钥需要求逆且有些微小差别，解密子密钥要么是加密子密钥的加法逆要么是乘法逆。（对IDEA而言，对于模256+1乘，全0子分组用256=-l来表示，因此0的乘法逆是0)。计算子密钥要花点时间，但对每一个解密密钥，只需做一次。</p>
<p>安全性：</p>
<p>差分攻击在第四轮之后免疫</p>
<p>能抗线性攻击分析</p>
<p>?&gt;IDEA也存在一族伪弱密钥（16进制），虽不完全像DES的弱密钥（呈现加密函数的自逆性），但相比表现为弱密钥特性，比如<code>0000，0000，0*00，0000，0000，000*，****，*000</code>在“*”位置的数任选，如果攻击者使用选择明文攻击，则很可能容易识别出来</p>
<h3 id="AES密码"><a href="#AES密码" class="headerlink" title="AES密码"></a>AES密码</h3><p>整个算法由10轮组成，每轮有四个不同部件：字节替换，行有移位，列混合和轮密钥加，最后一轮没有列混合。</p>
<p><img src="./index/cy20.png"></p>
<p>AES解密算法是加密算法的逆变换，其结构类型类似于加密算法结构</p>
<p>-逆字节替换</p>
<p>-逆行移位</p>
<p>-逆列混合</p>
<p>-轮密钥加的逆变换</p>
<p>详细实现过程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/luop/p/4334160.html">https://www.cnblogs.com/luop/p/4334160.html</a></p>
<h3 id="分组密码的操作模式"><a href="#分组密码的操作模式" class="headerlink" title="分组密码的操作模式"></a>分组密码的操作模式</h3><p>?&gt;电子密码本模式(ECB)：<br>对明文分组加密，使用相同的密钥进行加密</p>
<p>优点：支持并行加密</p>
<p>缺点：相同明文对应相同密文，容易暴露统计学特征</p>
<p>?&gt;密码分组链接模式(CBC):<br>每一个密文分组Ci在用密钥加密前，先和下一个明文分组Mi+1相异或</p>
<p>C0=IV</p>
<p>Ci=Enck(Mi⊕Ci-1)</p>
<p>Mi=Deck(Ci)⊕Ci-1</p>
<p><img src="./index/cy21.png"></p>
<p>优点：相同明文对应不同密文，更加安全，可以并行解密，改变一个明文分组，所有密文分组都会受影响，可用于认证</p>
<p>缺点：不能并行加密</p>
<p>?&gt;密码反馈模式(CFB)：产生一个密钥流，然后将其与明文相异或</p>
<p>C0=IV</p>
<p>Ci=Enck(Ci-1)⊕Mi</p>
<p>Mi=Ci⊕Enck(Ci-1)</p>
<p><img src="./index/cy22.png"></p>
<p>优点：加解密算法相同，运算速度快，密钥管理简单，可以并行解密，改变一个明文分组，所有密文分组都会受影响，可用于认证</p>
<p>缺点：不能并行加密</p>
<p>?&gt;输出反馈模式(OFB):</p>
<p>k0=IV0</p>
<p>ki=Enck(ki-1)</p>
<p>Ci=Mi⊕kI</p>
<p>Mi=Ci⊕Enck(ki-1)</p>
<p>优点：相同明文对应不同密文，同时加密，同时解密</p>
<p>缺点：改变明文分组Mi仅引起相应的密文分组Ci的改变，可能会造成统计信息泄露，但也有可能十分有用，例如用于通信信道，与卫星加密通信</p>
<h2 id="公钥密码学"><a href="#公钥密码学" class="headerlink" title="公钥密码学"></a>公钥密码学</h2><p>公钥密码学的研究方向：</p>
<p>基于大整数因子分解问题的RSA体制和Rabin体制</p>
<p>基于有限域上的离散对数问题的Diffie-Hellman公钥体制和EIGamal体制</p>
<p>基于椭圆曲线上的离散对数问题的Diffie-Hellman公钥体制和EIGamal体制</p>
<p>基于背包问题的Merkle-Hellman体制和Chor-Rivest体制</p>
<p>基于代数编码理论的McEliece体制</p>
<p>基于有限自动机理论的公钥体制</p>
<p>但是目前比较流行的公钥密码体制有两种：</p>
<p>一类是基于大整数因子分解问题的，其中最典型的代表是RSA体制</p>
<p>另一类是基于离散对数问题的，如EIGamal公钥密码体制和影响比较大的椭圆曲线公钥密码体制</p>
<h3 id="公钥密码体制的优缺点"><a href="#公钥密码体制的优缺点" class="headerlink" title="公钥密码体制的优缺点"></a>公钥密码体制的优缺点</h3><p>公钥密码体制的优点是可以适用网络的开放性要求，与对称密钥体制相比，密钥管理更简单，能方便的实现数字签名和认证</p>
<p>相对的缺点而言：公开密钥的算法相对复杂，加解密速度较低。在实际中往往结合使用，即加解密使用对称密钥体制，密钥管理使用公钥密码体制</p>
<h3 id="公钥密码体制模型"><a href="#公钥密码体制模型" class="headerlink" title="公钥密码体制模型"></a>公钥密码体制模型</h3><p>公钥密码体制在加解密时使用不同的密钥，这样通信双方无需提前交换密钥（避免了保密通信以及使用安全信道预先约定密钥的问题）</p>
<p>在公钥密码体制中，每个用户保留一对密钥，即公钥PK和私钥SK，PK是公开信息并且给出的公钥SK无法计算私钥PK，持有公钥的人对明文产生密文，只有持有私钥的人才能进行解密</p>
<p><img src="./index/cy23.png"></p>
<p>?&gt;从数学的角度看公钥密码体制就是一种陷门单向函数</p>
<p>单向函数：</p>
<p>它是定义域到值域的有一个映射，同时满足以下条件：计算函数值是容易的，而从函数值计算原像是是不可行的</p>
<p>陷门单向函数：</p>
<p>对一个单向函数，存在一个附加信息，当不知道该附加信息时，从函数值求原像是困难的，但当知道该附加信息时，从函数值求原像就比较简单。即陷门单向函数在附加信息未知时是单向函数，当附加信息已知时，不再是单向函数，且称附加信息为陷门信息</p>
<p>公钥密码体制就是将一个陷门单向函数，将它作为公开密钥，而将陷门信息作为秘密密钥，其安全强度取决于它所依据的问题的计算复杂度</p>
<p>基本要求：</p>
<p>产生一对密钥在计算上可行</p>
<p>已知公钥和明文，产生密文是简单的</p>
<p>接收方利用私钥来解密密文在计算上是可行的</p>
<p>对于攻击者，利用公钥来推断私钥在计算上是不可行的</p>
<p>对于公钥和密文，在不知道私钥的情况下，恢复明文在计算上是不可行的</p>
<h2 id="数学基础"><a href="#数学基础" class="headerlink" title="数学基础"></a>数学基础</h2><p>?&gt;群的概念：</p>
<p>设G是一个非空集合，并在G内定义了一种代数运算”o”，若满足：</p>
<p>封闭性：对任意a，b，c∈G，均有aob∈G成立；</p>
<p>结合律：对于任意a，b，c∈G，均有(aob)oc=ao(boc)成立；</p>
<p>单位元：G中存在一恒等元1G，对于任意a∈G，均有ao1G=1Goa=1G；</p>
<p>逆元：对任意a∈G，存在a的逆元a^-1∈G，使得aoa^-1=a^-1oa=1G成立。</p>
<p>则称(G,o)构成一个群。</p>
<p>例子全体整数对加法构成群，对乘法不构成群</p>
<p>对乘法0没有逆元，故对乘法不构成群</p>
<p>?&gt;补充：群公理的两个重要结果是单位元和逆元的唯一性。在群中只能有一个单位元，而群中的每个元素都正好有一个逆元素。</p>
<h3 id="数论基础-信息安全数学基础"><a href="#数论基础-信息安全数学基础" class="headerlink" title="数论基础(信息安全数学基础)"></a>数论基础(信息安全数学基础)</h3><p>?&gt;简单定义1： </p>
<p>若a能整除b,记为a|b</p>
<p>若a|b,那么对任何整数c，都有a|bc</p>
<p>若a|b，b|c，那么有a|c</p>
<p>若a|b，a|c，那么对任何整数x和y，都有a|(bx+cy)</p>
<p>若a|b，b|a，那么a=+-b</p>
<p>若a|b，a&gt;0，b&gt;0，那么a&lt;=b</p>
<p>?&gt;简单定义2：</p>
<p>带余除法：给定任意整数a和b，且a&gt;0，必存在唯一的整数q和r，满足b=qa+r，其中<code>0&lt;=r&lt;a</code>。式中q称为商数，r称为余数，该式称为除法算式，其运算过程为带余除法</p>
<p>最大公因数：若a，b，c都是整数，且a|b，a|c，那么称a是b和c的公因数。在所有公因数中最大的一个，称为最大公因数，并记为gcd(b,c)或(b,c)</p>
<p>最小公倍数：设a，b，c都是整数，a，b都不为0，如果a|c，b|c，则称c是a和b的公倍数；如果a和b的公倍数c除尽a和b的任一个公倍数，，则称c是a和b的最小公倍数，记为c=lcm(a,b)或c=[a,b]</p>
<p>?&gt;简单定义3：</p>
<p>若一个大于1的正整数p，只能被1和它本身整除，不能被其他正整数整除，则称这样的正整数p为素数或质数</p>
<p>大于1的整数n都可以分解为素数的乘积</p>
<p>如果a和b的最大公因数是1，即gcd(a,b)=1，则称a和b互素</p>
<p>?&gt;简单定义4：</p>
<p>欧几里得算法：</p>
<p>给定整数b和c，且c&gt;0，重复使用带余除法，即用每次的余数为除数去除上一次的除数，直至余数为0，这样可得下面一组方程：</p>
<p>b=c*q1+r1,    <code>0&lt;r1&lt;c</code></p>
<p>c=r1*q2+r2,   <code>0&lt;r2&lt;r1</code></p>
<p>r1=r2*q3+r3,  <code>0&lt;r3&lt;r2</code></p>
<p>···</p>
<p>rj+1=rj*qj+1</p>
<p>最后一个不为0的余数rj就是b和c的最大公因数gcd(b,c)</p>
<p>?&gt;简单定义5：</p>
<p>费马小定理：令p为素数，如果gcd(p,a)=1，则有：</p>
<p>a^p-1≡1 mod p</p>
<p>然而，对任何正整数a，恒有：</p>
<p>a^p≡a mod p</p>
<p>欧拉定理:如果gcd(a,m)=1，则恒有：</p>
<p>a^∅(m)≡1 mod m</p>
<p>其中∅(m)是欧拉函数，∅(m)的值等于小于m且与m互素的正整数的个数</p>
<p>欧拉函数的性质：令m和n表示任意两个互素的正整数，即gcd(m,n)=1，则∅(mn)=∅(m)∅(n)</p>
<p>?&gt;简单定义6：</p>
<p>中国剩余定理：设m1，m2，···，mk是两两互素的正整数，令</p>
<p>M=m1m2···mk=m1M1=m2M2···=mkMk，</p>
<p>式中Mi=M/mi，i=1，2···，k，则下面的同于方程组：</p>
<p>x≡bi  mod mi   i=1，2，3，···，k</p>
<p>的正整数解x0存在且在模M的意义下是唯一的。</p>
<p>x0=b1M1’M1+b2M2’M2+···+bkMk’Mk mod M</p>
<p>式中M’满足：</p>
<p>Mi’Mi≡1  mod  mi  ,  i=1，2，3，···k</p>
<p>的正整数，即Mi’是Mi以mi为模的乘法逆元</p>
<p>?&gt;简单定义7</p>
<p>设a和n互素，若方程x^2≡a  mod  n 有解，则称a是模n的平方剩余，否则称为非平方剩余</p>
<p>定理4.2.1（有区别）：</p>
<p>若p是奇素数，p不能整除a，则x^2≡a  mod  p或无解或有两个模p不同余的解</p>
<p>定理4.2.2：</p>
<p>若p是奇素数，则整数1，2，···，p-1中正好有(p-1)/2个是模p的平方剩余，其余的(p-1)/2个是非平方剩余</p>
<p>?&gt;定义：Blum整数</p>
<p>如果p和q是两个素数，且p≡3  mod  4，q≡3  mod  4，那么n=p*q称为Blum整数。如果n是一个Blum整数，那么它的每一个二次剩余恰好有4个平方根，其中一个也是平方，也就是主平方根 </p>
<p>?&gt;定义5.1.1：本原元</p>
<p>如果p是一个素数，且g小于p，若对于从0到p-1的每一个y，都存在某个x，使得g^x≡y  mod  p成立，那么g是Zp的乘法群Zp*的某个生成元，称g是模p的本原元</p>
<h2 id="陷门单向函数与困难性问题"><a href="#陷门单向函数与困难性问题" class="headerlink" title="陷门单向函数与困难性问题"></a>陷门单向函数与困难性问题</h2><p>单向函数是求逆困难的函数，而陷门单向函数是在不知道陷门信息的条件下求逆困难的函数，当知道陷门信息后，求逆是易于实现的。定义：陷门单向函数是满足下列条件的函数f：</p>
<p>1.给定x，计算y=f(x)是容易的。</p>
<p>2.给定y，计算y=f(x)的x是困难的。</p>
<p>存在δ(陷门)，已知δ时，对给定的任何y，若相应的x存在，则计算满足y=f(x)的x是容易的。</p>
<p>注解：</p>
<p>1.仅满足1，2两条的称为单向函数；第3条称为陷门性，δ称为陷门信息</p>
<p>2.当用陷门函数用于公钥加密，只需将f当作公钥，δ作私钥即可。单向陷门函数的第二条性质表明窃听者由皆获得密文y=f(x)推测明文x是不可行的。</p>
<p>?&gt;困难性问题：</p>
<p>1.离散对数问题DLP：</p>
<p>给定一个大素数p阶群G，生成元g∈G和y∈RG，求解满足y=g^x的x∈Zp</p>
<p>2.大整数分解问题</p>
<p>已知两个大素数p和q，求n=pq十分容易，但若由n，求p和q是十分困难的，这就是大整数分解性问题</p>
<p>3.计算Diffie-Hellman问题：</p>
<p>给定一大素数p阶群G，以及g，g^a，g^b∈G，求g^ab的问题称为CDH问题</p>
<p>4.判断Diffie-Hellman问题：</p>
<p>给定一大素数p阶群G，以及g，g^a，g^b∈G和Z∈RG，判断Z是否等于g^ab的问题称为DDH问题</p>
<p>详细解释见：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhuowangy2k/p/11901028.html">https://www.cnblogs.com/zhuowangy2k/p/11901028.html</a></p>
<p>5.平方剩余问题：</p>
<p>当n是合数时，若n的分解位置，则求方程x^2≡a  mod  n的解时困难的</p>
<h3 id="RSA公钥加密方案"><a href="#RSA公钥加密方案" class="headerlink" title="RSA公钥加密方案"></a>RSA公钥加密方案</h3><p>密钥生成算法KeyGen：</p>
<p>1.首先选取两个大素数p和q，计算n=pq，其欧拉函数值为∅(n)=(p-1)(q-1)</p>
<p>2.随机选取整数e，满足gcd(e,∅(n))=1,并计算d=e^-1  mod  ∅(n)</p>
<p>公钥为pk=(e,n)，私钥是sk=d。p，q是秘密参数，需要保密，如不需要保存，可销毁。</p>
<p>加密运算Enc(pk，m)：对于明文m∈Zm，利用公钥pk=(e,n)产生密文c=m^e  mod  n。</p>
<p>!&gt;注意：m必须是整数（字符串可以取ascii值或unicode值），且m必须小于n。</p>
<p>解密运算Dec(sk,C):给定密文C∈Zn，利用私钥sk=e计算c^d≡ m  mod  n</p>
<p>详细证明：<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html</a></p>
<p>具体细则：</p>
<p>采取足够大的整数n(至少应取1024位，最好2048位)</p>
<p>对素数p和q选取应满足以下要求：</p>
<p>1.p和q的长度应该相差不大。</p>
<p>2.(p-1)和(q-1)都应该包含大的素因子。</p>
<p>3.gcd(p-1,q-1)应该尽可能小</p>
<p>4.当d&lt;n，且d&lt;n^0.294，特别是d&lt;n^0.25时，已经有办法攻破RSA</p>
<h3 id="EIGamal公钥密码体制"><a href="#EIGamal公钥密码体制" class="headerlink" title="EIGamal公钥密码体制"></a>EIGamal公钥密码体制</h3><p>密钥生成算法KeyGen(k)：选取k比特大素数p阶群G。选取生成元g∈G及x∈ZP*。计算y=g^x。公钥为pk=(G,p,g,y)，私钥为sk=x。</p>
<p>加密算法：Enc(pk,m):待加密的消息为m∈Zp。首先选取r∈Zp<em>，计算C1=g^r，C2=m</em>y^r最后输出密文C=(C1,C2)。</p>
<p>解密算法Dec(sk,C)：收到密文C=(C1,C2)后，计算m=C2/C1^x</p>
<p>解密正确性：</p>
<p>由于y=g^x，因此：</p>
<p><code>C2/C1^x=m*y^r/g^rx=m*y^r/y^r=m</code></p>
<h3 id="Cramer-Shoup非对称公钥密码体制"><a href="#Cramer-Shoup非对称公钥密码体制" class="headerlink" title="Cramer-Shoup非对称公钥密码体制"></a>Cramer-Shoup非对称公钥密码体制</h3><p>1.从一个循环群G选出阶为q有两个不同的生成元g1,g2</p>
<p>2.x1,x2,y1,y2随机整数</p>
<p>3.c=g1^x1g2^x2，d=g1^y1g2^y2，h=g1^z</p>
<p>4.单向散列函数：H</p>
<p>5.PK=(G,q,g1,g2,c,d,h)</p>
<p>?&gt;加密：</p>
<p>选择随机数k从{0,…,q-1}，计算：</p>
<p>u1=g1^k，u2=g2^k</p>
<p>e=m*h^k</p>
<p>a=H(u1,u2,e)</p>
<p>v=(c^k)(d^ka)</p>
<p>发送(u1,u2,e,v)</p>
<p>?&gt;解密：</p>
<p>计算a=H(u1,u2,e)并验证(u1^x1)(u2^x2)((u1^y1)(u2^y2))^a=v。如果测试失败，则终止解密</p>
<p>否则m=e/(u1^z)</p>
<h3 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h3><p>RSA算法不能通过IND-CPA,IND-CCA,IND-CCA2</p>
<p>EIGMAL算法不能通过IND-CCA2</p>
<p>Cramer-shoup都能同通过</p>
<h3 id="公钥密码体制的安全模型"><a href="#公钥密码体制的安全模型" class="headerlink" title="公钥密码体制的安全模型"></a>公钥密码体制的安全模型</h3><p>由两个安全目标和敌手的攻击能力两个因素来刻画：</p>
<p>?&gt;安全目标：</p>
<p>1.单向性(OW)：希望敌手不能获得密文对应的整个明文</p>
<p>2.不可区分性(IND)：希望敌手不能获得明文的任意信息，哪怕明文的一个比特。换而言之，给定两个等长的明文，以及一个对应其中之一明文的密文，敌手也无法确定该密文对应哪个明文</p>
<p>?&gt;敌手的攻击能力：</p>
<p>1.选择明文攻击(CPA)：敌手可以得到任意明文所对应的密文</p>
<p>2.选择密文攻击(CCA)：敌手还可以进一步得到一些密文所对应的明文</p>
<p>因此公钥加密方案有：OW-CPAOW-CCA，IND-CPA，IND-CCA等安全模型</p>
<h3 id="IND-CPA"><a href="#IND-CPA" class="headerlink" title="IND-CPA"></a>IND-CPA</h3><p>可以通过一个在敌手A和挑战者C之间的游戏来定义：</p>
<p>Setup阶段：挑战者C运行(pk,sk)←KeyGen(k)。然后将pk交给敌手</p>
<p>Challenge阶段：敌手A提交两个等长的明文m0，m1。挑战者C随机算去δ←{0,1}，计算C*=Enc(pk,mδ)，然后将C*交给敌手A</p>
<p>Guess阶段：敌手A输出猜测δ’。若δ’=δ，则称敌手A赢得该游戏。</p>
<p>我们将敌手A针对该公钥加密方案的优势定义为Adv=|Pr[δ’=δ]-1/2|</p>
<p>若对于任意上述多项式时间地搜A，它针对一个公钥加密方案的优势都是可忽略的，则称该共哟啊加密方案是 IND-CPA安全的。</p>
<h3 id="EIGamal加密方案的的IND-CPA安全性证明"><a href="#EIGamal加密方案的的IND-CPA安全性证明" class="headerlink" title="EIGamal加密方案的的IND-CPA安全性证明"></a>EIGamal加密方案的的IND-CPA安全性证明</h3><p>DDH问题：给定一大素数p阶群G,g,g^a,g^b∈G。令β∈{0,1}为一个随机比特。若β=1，令Z=g^ab；若β=0，令Z为群G中的一个随机元素。</p>
<p>那么DDH问题就是：给定(g,g^a,g^b,Z)，输出β的猜测β’。若|Pr[β’=β]-1/2|&gt;=ε，则存在一个算法具有优势ε结局群G中的DDH问题。</p>
<p>若不存在t时间的算法能够以优势ε来解决G中的DDH问题，则称群G的DDH问题是(t,ε)困难的。</p>
<p>若群G上的DDH问题是困难的，则EIGamal方案是IND-CPA安全的。</p>
<h3 id="IND-CCA2"><a href="#IND-CCA2" class="headerlink" title="IND-CCA2"></a>IND-CCA2</h3><p>可以通过一个在敌手A和挑战者C之间的游戏来定义：</p>
<p>Setup阶段：挑战者C运行(pk,sk)←KeyGen(k)。然后将pk交给敌手。</p>
<p>Phase1：敌手可以进行一系列的解密查询。当敌手提交一个密文C进行查询时，挑战者C将Dec(sk,C)的结果返回给敌手A。</p>
<p>Challenge阶段：敌手A提交两个等长的明文m0，m1。挑战者随机选取γ←{0,1}，计算C*=Enc(pk,mγ)，然后将C*交给敌手A。</p>
<p>Phase2：敌手A可以继续进行解密查询，但敌手不能对挑战密文C*进行查询</p>
<p>Guess阶段：敌手A输出猜测γ’，若γ’=γ，则称敌手赢得该游戏。我们将敌手A针对该公钥加密方案的优势定义为Adv=|Pr[γ’=γ]-1/2|</p>
<p>若对于任意上述多项式时间敌手A，它针对一个公钥加密方案的优势都是可忽略的，则称该公钥加密方案时ICD-CCA2安全的。</p>
<h3 id="Cramer-Shoup加密方案安全性证明"><a href="#Cramer-Shoup加密方案安全性证明" class="headerlink" title="Cramer-Shoup加密方案安全性证明"></a>Cramer-Shoup加密方案安全性证明</h3><p>提要：若群G上的DDH问题时困难的，则Cramer-Shoup方案是IND-CCA2安全的</p>
<p>证明：假定存在一个敌手A可以攻破Cramer-Shoup方案的IND-CCA2安全性，那么可以存在一个多项式时间算法β可以解决群G上的DDH困难问题。</p>
<p>给定(g,A=g^a,B=g^b,Z)∈G^4，算法β通过按照如下方式与敌手A进行交互来结局DDH困难问题：</p>
<p>Setup阶段：算法β选取x1,x2,y1,y2,z1,z2∈Zp*，然后设定g1=g，g2=A以及c=(g1^x1)(g2^x2)，d=(g1^y1)(g2^y2)，h=(g1^z1)(g2^z2)。最后将公钥pk=(g1,g2,c,d,g,H)交给敌手A</p>
<p>Phase 1：敌手A可以进行一系列的解密查询。当敌手A提交一个密文C=(u1,u2,e,v)进行查询时，算法首先计算α=H(u1,u2,e)，然后判断<code>u1^(x1+α*y1)u2^(x2+α*y2)=v</code>是否成立，若不成立，输出“密文无效！”；否则输出m=e/(u1^z1)(u2^z2)</p>
<p>Challege阶段：当敌手决定结束Phase1时，他提交两个等长的明文m0，m1∈G。算法β随机选择γ∈{0,1}，然后将挑战密文设定为C*=(u1*,u2*,e*,v*)并交给敌手A，其中：</p>
<p>u1*=B，u2*=Z，e*=(B^z1)(Z^z2)mγ，v*=(A^x1+y1α*)(B^x2+y2α*)</p>
<p>此处a*=H(u1*,u2*,e*)。容易验证，若Z=g^ab，该密文确实是一个合法的挑战密文。</p>
<p>Phase2阶段：敌手A可以继续进行一系列的解密查询，此处要求敌手不能对C*进行查询。算法β采用类似Phase1的策略应答敌手A的查询。</p>
<p>Guess阶段：最后，敌手输出一个猜测γ’∈{0,1}。若y’=y，算法输出β’=1作为他对DDH问题的猜测；否则输出β’=0</p>
<h2 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h2><h3 id="数字签名基本需求与组成"><a href="#数字签名基本需求与组成" class="headerlink" title="数字签名基本需求与组成"></a>数字签名基本需求与组成</h3><p>1.接收方能够确认或证实发送方的签名，但不能伪造</p>
<p>2.发送方发出签名的消息给接收方后，就不能在否认他所签发的消息</p>
<p>3.接收方对已收到的签名消息不能否认</p>
<p>4.第三者可以确认收发双方之间的消息传送，但不能伪造这一过程</p>
<p>?&gt;数字签名算法的组成：</p>
<p>密钥生成算法KeyGen(k)：输入安全参数k，输出用户的公/私钥对(pk,sk)</p>
<p>签名算法Sign(sk,m)：输入私钥sk和消息m，该算法输出签名σ</p>
<p>验证算法Verify(pk,σ,m)：输入公钥pk和签名σ。若σ是针对pk和m的一个有效签名，则算法输出1，否则输出0</p>
<p>算法的正确性要求对于任意m，均有Verify(pk,Sign(sk,m))=1成立</p>
<h3 id="RSA签名方案"><a href="#RSA签名方案" class="headerlink" title="RSA签名方案"></a>RSA签名方案</h3><p>密钥生成算法KeyGen(k):</p>
<p>1.1:首先选取两个大素数p和q，计算n=pq，其欧拉函数值为∅(n)=(p-1)(q-1)</p>
<p>1.2:随机选取整数e，满足gcd(e,∅(n))=1，并计算d=e^-1  mod  ∅(n)</p>
<p>2:签名算法Sign(sk=d,m)：对于签名m属于Zn，其签名为σ=H(m)^d    mod  n</p>
<p>3.签名验证算法Verify(pk=e,σ,m)。当接收者收到签名σ时，检验m=σ^e  mod  n</p>
<h3 id="EIGmal签名方案"><a href="#EIGmal签名方案" class="headerlink" title="EIGmal签名方案"></a>EIGmal签名方案</h3><p>密钥生成算法KeyGen：设p是一个大素数，使得模p上的离散对数问题是困难的。选取生成元g∈ZP<em>。此外，选取一个防碰撞的hash函数H：{0,1}含于∈ZP</em>。随机选取x∈ZP*，令y=g^x  mod  p。公钥为pk=(G,p,g,y,H)，私钥为sk=x。</p>
<p>签名算法Sign(sk,m):选取随机数0&lt;k&lt;p-1,且gcd(k,p-1)=1，计算r=g^k(mod p)和s=(H(m)-x*r)k^-1(mod  p-1)。最后输出签名σ=(r,s)。</p>
<p>签名验证算法Verify(pk,σ,m):检查g^H(m)=(y^r)*(r^s)</p>
<p><img src="./index/cy24.png"></p>
<h3 id="Schnorr签名方案"><a href="#Schnorr签名方案" class="headerlink" title="Schnorr签名方案"></a>Schnorr签名方案</h3><p>密钥生成算法KeyGen：选取一个阶为大素数p的群G。选取生成元g∈G。此外，选取一个防碰撞的hash函数H：{0,1}含于∈ZP<em>。随机选取x∈ZP</em>，令y=g^x  mod  p。公钥为pk=(G,p,g,y,H)，私钥为sk=x。</p>
<p>签名算法Sign(sk,m):选取随机数k∈ZP<em>，计算R=g^k，e=H(m,R)，s=(k-x</em>e) mod p。最后输出签名σ=(e,s)。</p>
<p>签名验证算法Verify(pk,σ,m):R’=(g^s)(y^e)。检查H(m,R’)=e是否成立。若成立输出1，否则输出0</p>
<p>变型：也可以公布(R,s)作为签名</p>
<h3 id="数字签名标准"><a href="#数字签名标准" class="headerlink" title="数字签名标准"></a>数字签名标准</h3><p>密钥生成算法KeyGen：选取512至1024位的大素数p，且(p-1)有一个160比特的素因子q。选取一个模p的阶位q的数g。然后随机选取x满足0&lt;x&lt;q。将公钥设为y=g^x，私钥设为sk=x。</p>
<p>签名算法Sign(sk,m):选取随机数k满足0&lt;k&lt;q，计算r=(g^k mod  p)  mod  q，s=(k^-1(H(m)+xr)) mod q。最后输出σ=(r,s)。</p>
<p>签名验证算法Verify(pk,σ,m):计算w=s^-1  mod  q，u1=H(m)w  mod  q，u2=rw  mod  q。检查(g^u1y^u2  mod  p)mod  q  =  r是否成立。若成立输出1，否则输出0</p>
<h3 id="签名的安全模型"><a href="#签名的安全模型" class="headerlink" title="签名的安全模型"></a>签名的安全模型</h3><p>选择消息攻击下的存在性不可伪造(UNF-CMA):</p>
<p>起始阶段：挑战者C运行KeyGen算法来产生公/私钥对(pk,sk)，然后把公钥pk交给敌手A</p>
<p>问询阶段：在此阶段，敌手A可以进行一系列的查询。当A提交一个消息mi时，挑战者C运行Sign(sk,m)，然后将产生的签名σi交给敌手。</p>
<p>挑战阶段：最后敌手A输出(m*,σ*)，若Verify(pk,σ,m)=1，且敌手A未在询问阶段问过m*，则称敌手A赢得该游戏，若优势可忽略则称该签名方案是EUF-CMA安全的</p>
<p>123</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">莫梁斐</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://lunarsama.ga/mimaxue/index.html">https://lunarsama.ga/mimaxue/index.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">莫梁斐</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay1.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat1.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/mimaxue/index.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="密码学基础">
                        
                        <span class="card-title">密码学基础</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            莫梁斐
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                本篇&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/mimaxue/index.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="密码学基础">
                        
                        <span class="card-title">密码学基础</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            莫梁斐
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">莫梁斐</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">3.4k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lunasama1/lunasama1.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1253896566@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1253896566" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1253896566" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
